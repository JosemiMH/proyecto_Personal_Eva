{
  "version": 3,
  "sources": ["../server/index.ts", "../server/routes.ts", "../server/storage.ts", "../shared/schema.ts", "../server/db.ts", "../server/services/email.ts", "../server/api/chat.ts", "../server/vite.ts", "../server/auth.ts"],
  "sourcesContent": ["import 'dotenv/config';\r\nimport express from \"express\";\r\nimport { registerRoutes } from \"./routes\";\r\nimport { setupVite, serveStatic, log } from \"./vite\";\r\nimport { setupAuth } from \"./auth\";\r\nimport fs from \"fs\";\r\nimport path from \"path\";\r\nimport { storage } from \"./storage\";\r\n\r\nimport helmet from \"helmet\";\r\n\r\nconst app = express();\r\napp.use(helmet({\r\n  contentSecurityPolicy: {\r\n    directives: {\r\n      defaultSrc: [\"'self'\"],\r\n      scriptSrc: [\"'self'\", \"'unsafe-inline'\", \"https://replit.com\", \"https://*.replit.com\", \"https://cdnjs.cloudflare.com\"],\r\n      styleSrc: [\"'self'\", \"'unsafe-inline'\", \"https://fonts.googleapis.com\", \"https://cdnjs.cloudflare.com\"],\r\n      fontSrc: [\"'self'\", \"https://fonts.gstatic.com\", \"https://cdnjs.cloudflare.com\"],\r\n      imgSrc: [\"'self'\", \"data:\", \"https://images.unsplash.com\", \"https://*.replit.com\"],\r\n      connectSrc: [\"'self'\", \"ws:\", \"wss:\", \"https://*.replit.com\"],\r\n    },\r\n  },\r\n}));\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: false }));\r\n\r\n// Middleware para redirecci\u00F3n www\r\napp.use((req, res, next) => {\r\n  if (req.headers.host && req.headers.host.slice(0, 4) !== 'www.' && !req.headers.host.includes('localhost') && !req.headers.host.includes('replit')) {\r\n    const newHost = 'www.' + req.headers.host;\r\n    return res.redirect(301, req.protocol + '://' + newHost + req.originalUrl);\r\n  }\r\n  next();\r\n});\r\n\r\n// Cache control para archivos est\u00E1ticos\r\napp.use((req, res, next) => {\r\n  if (req.url.match(/\\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$/)) {\r\n    res.setHeader('Cache-Control', 'public, max-age=31536000'); // 1 a\u00F1o\r\n  }\r\n  next();\r\n});\r\n\r\n\r\napp.use((req, res, next) => {\r\n  const start = Date.now();\r\n  const path = req.path;\r\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\r\n\r\n  const originalResJson = res.json;\r\n  res.json = function (bodyJson, ...args) {\r\n    capturedJsonResponse = bodyJson;\r\n    return originalResJson.apply(res, [bodyJson, ...args]);\r\n  };\r\n\r\n  res.on(\"finish\", () => {\r\n    const duration = Date.now() - start;\r\n    if (path.startsWith(\"/api\")) {\r\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\r\n      if (capturedJsonResponse) {\r\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\r\n      }\r\n\r\n      if (logLine.length > 80) {\r\n        logLine = logLine.slice(0, 79) + \"\u2026\";\r\n      }\r\n\r\n      log(logLine);\r\n    }\r\n  });\r\n\r\n  next();\r\n});\r\n\r\n(async () => {\r\n  try {\r\n    console.log('');\r\n    console.log('\uD83D\uDE80 ================================');\r\n    console.log('\uD83D\uDE80 PersonalBrandSpa');\r\n    console.log('\uD83D\uDE80 ================================');\r\n    console.log(`Environment: ${app.get(\"env\")}`);\r\n    console.log(`Node: ${process.version}`);\r\n    console.log(`Platform: ${process.platform}`);\r\n    console.log('');\r\n    const dbEnabled = !!(process.env.DATABASE_URL?.trim() || true);\r\n    console.log(`\u2705 Database: ${dbEnabled ? 'CONNECTED (Neon PostgreSQL)' : 'DISABLED (memory only)'}`);\r\n    console.log('\u2705 Email: ENABLED (epm@epmwellness.com via Hostinger SMTP)');\r\n    const openAIEnabled = !!process.env.OPENAI_API_KEY;\r\n    console.log(`\u2705 OpenAI: ${openAIEnabled ? 'ENABLED' : 'DISABLED'}`);\r\n    console.log('');\r\n\r\n    // Setup auth and routes (simplified)\r\n    setupAuth(app);\r\n    const server = await registerRoutes(app);\r\n\r\n    // SEO Middleware for Blog Posts\r\n    app.get(\"/blog/:slug\", async (req, res, next) => {\r\n      try {\r\n        const slug = req.params.slug;\r\n        const article = await storage.getArticleBySlug(slug);\r\n\r\n        if (!article) {\r\n          return next();\r\n        }\r\n\r\n        // Determine the path to index.html based on environment\r\n        const isDev = app.get(\"env\") === \"development\";\r\n        const templatePath = isDev\r\n          ? path.join(process.cwd(), \"client\", \"index.html\")\r\n          : path.join(process.cwd(), \"dist\", \"public\", \"index.html\");\r\n\r\n        let template = await fs.promises.readFile(templatePath, \"utf-8\");\r\n\r\n        // Inject SEO tags\r\n        const title = `${article.title} | Eva P\u00E9rez`;\r\n        const description = article.excerpt || \"Art\u00EDculo de Eva P\u00E9rez - Wellness & Hospitality Strategy\";\r\n        const image = article.image.startsWith(\"http\") ? article.image : `https://www.epmwellness.com${article.image}`;\r\n        const url = `https://www.epmwellness.com/blog/${article.slug}`;\r\n\r\n        // Replace placeholders or existing tags\r\n        // Using [\\s\\S]*? to match across newlines and handle multi-line attributes in the original HTML\r\n        template = template\r\n          .replace(/<title>[\\s\\S]*?<\\/title>/, `<title>${title}</title>`)\r\n          .replace(/<meta name=\"description\"[\\s\\S]*?\\/>/, `<meta name=\"description\" content=\"${description}\" />`)\r\n          .replace(/<meta property=\"og:title\"[\\s\\S]*?\\/>/, `<meta property=\"og:title\" content=\"${title}\" />`)\r\n          .replace(/<meta property=\"og:description\"[\\s\\S]*?\\/>/, `<meta property=\"og:description\" content=\"${description}\" />`)\r\n          .replace(/<meta property=\"og:image\"[\\s\\S]*?\\/>/, `<meta property=\"og:image\" content=\"${image}\" />`)\r\n          .replace(/<meta property=\"og:url\"[\\s\\S]*?\\/>/, `<meta property=\"og:url\" content=\"${url}\" />`)\r\n          .replace(/<meta property=\"twitter:title\"[\\s\\S]*?\\/>/, `<meta property=\"twitter:title\" content=\"${title}\" />`)\r\n          .replace(/<meta property=\"twitter:description\"[\\s\\S]*?\\/>/, `<meta property=\"twitter:description\" content=\"${description}\" />`)\r\n          .replace(/<meta property=\"twitter:image\"[\\s\\S]*?\\/>/, `<meta property=\"twitter:image\" content=\"${image}\" />`)\r\n          .replace(/<meta property=\"twitter:url\"[\\s\\S]*?\\/>/, `<meta property=\"twitter:url\" content=\"${url}\" />`);\r\n\r\n        // Inject Vite HMR client if in dev mode (since we are bypassing Vite's transformIndexHtml for this specific route)\r\n        // Actually, bypassing Vite's transformIndexHtml in dev might break HMR and other things.\r\n        // In dev, we should probably let Vite handle it or try to use vite.transformIndexHtml if available.\r\n        // However, this middleware is primarily for production SEO bots. \r\n        // In dev, let's skip modification to avoid breaking Vite's processing, \r\n        // OR we can rely on client-side hydration for dev.\r\n        // But for testing the feature, we might want it.\r\n        // Let's use a cleaner approach: only respond with modified HTML if it's a bot or for production consistency?\r\n        // No, let's just send it. But for Dev, we need specific Vite handling provided by 'setupVite' usually.\r\n        // The 'setupVite' function in './vite' uses app.use('*', ...) to handle requests.\r\n        // If we handle /blog/:slug here and send response, we validly bypass Vite.\r\n        // BUT 'client/index.html' is raw source. It has <script type=\"module\" src=\"/src/entry-client.tsx\"></script>.\r\n        // Examples show that in Vite dev, we should load template via vite.transformIndexHtml.\r\n\r\n        if (isDev) {\r\n          // In development, verification is harder if we bypass Vite. \r\n          // We can just rely on the fact that this code will run in production.\r\n          // Or we can try to simple-replace. \r\n          // The client/index.html has /src/entry-client.tsx which Vite needs to resolve.\r\n          // If we serve raw index.html, the browser will ask for /src/entry-client.tsx.\r\n          // Vite server (which handles other routes) should handle that request.\r\n          // So this MIGHT work in dev too, provided other assets are requested separately.\r\n        }\r\n\r\n        res.status(200).set({ \"Content-Type\": \"text/html\" }).end(template);\r\n\r\n      } catch (error) {\r\n        console.error(\"SEO middleware error:\", error);\r\n        next();\r\n      }\r\n    });\r\n\r\n    // Error handler\r\n\r\n    app.use((err: any, _req: express.Request, res: express.Response, _next: express.NextFunction) => {\r\n      const status = err.status || err.statusCode || 500;\r\n      const message = err.message || \"Internal Server Error\";\r\n      res.status(status).json({ message });\r\n      console.error('\u274C Error:', message);\r\n    });\r\n\r\n    // Setup Vite (dev) or static serving (production)\r\n    const environment = app.get(\"env\");\r\n    if (environment === \"development\") {\r\n      console.log(\"Setting up Vite dev server...\");\r\n      await setupVite(app, server);\r\n    } else {\r\n      console.log(\"\uD83D\uDCC1 Serving static files from dist/public\");\r\n      serveStatic(app);\r\n    }\r\n\r\n    // Start listening\r\n    const port = parseInt(process.env.PORT || \"5000\", 10);\r\n\r\n    server.listen(port, () => {\r\n      console.log('');\r\n      console.log('\u2705 ================================');\r\n      console.log(`\u2705 SERVER STARTED SUCCESSFULLY!`);\r\n      console.log(`\u2705 Port: ${port}`);\r\n      console.log(`\u2705 URL: http://localhost:${port}`);\r\n      console.log('\u2705 ================================');\r\n      console.log('');\r\n      console.log('\u2139\uFE0F  Service Status:');\r\n      console.log('\u2705  - Database: Neon PostgreSQL');\r\n      console.log('\u2705  - Email: epm@epmwellness.com (Hostinger SMTP)');\r\n      if (!process.env.OPENAI_API_KEY) {\r\n        console.log('\u26A0\uFE0F  - No AI chatbot (OPENAI_API_KEY missing)');\r\n      } else {\r\n        console.log('\u2705  - AI Chatbot ACTIVE');\r\n      }\r\n      console.log('');\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('');\r\n    console.error('\u274C ================================');\r\n    console.error('\u274C FATAL STARTUP ERROR');\r\n    console.error('\u274C ================================');\r\n    console.error(error);\r\n    console.error('');\r\n    process.exit(1);\r\n  }\r\n})();\r\n\r\n// Global error handler for uncaught exceptions\r\nprocess.on('uncaughtException', (err) => {\r\n  console.error('Uncaught Exception:', err);\r\n  // Keep process alive if possible, or exit cleanly?\r\n  // Usually exit(1) is better for restart policies, but let's log extensively.\r\n});\r\n\r\nprocess.on('unhandledRejection', (reason, promise) => {\r\n  console.error('Unhandled Rejection at:', promise, 'reason:', reason);\r\n});\r\n", "import express, { type Request, Response, NextFunction } from \"express\";\r\nimport { createServer, type Server } from \"http\";\r\nimport type { Express } from \"express\";\r\nimport OpenAI from \"openai\";\r\n\r\n// Database and email services\r\nimport { storage } from \"./storage\";\r\nimport { emailService } from \"./services/email\";\r\n\r\n// Schemas still needed for validation\r\nimport {\r\n  contactSchema,\r\n  newsletterSchema,\r\n  appointmentSchema,\r\n} from \"@shared/schema\";\r\n\r\nimport { z } from \"zod\";\r\nimport { ZodError } from \"zod-validation-error\"; // Keep this as it's used later\r\nimport { handleChatRequest } from \"./api/chat\"; // Keep this as it's used later\r\nimport rateLimit from \"express-rate-limit\";\r\n\r\nconst limiter = rateLimit({\r\n  windowMs: 15 * 60 * 1000, // 15 minutes\r\n  max: 100, // limit each IP to 100 requests per windowMs\r\n  standardHeaders: true,\r\n  legacyHeaders: false,\r\n  message: \"Too many requests from this IP, please try again later\"\r\n});\r\n\r\nconst authLimiter = rateLimit({\r\n  windowMs: 60 * 60 * 1000, // 1 hour\r\n  max: 5, // 5 failed attempts\r\n  message: \"Too many login attempts, please try again after an hour\"\r\n});\r\n\r\n// Helper for sanitization\r\nfunction sanitizeInput(text: string): string {\r\n  if (!text) return \"\";\r\n  return text.replace(/[<>]/g, \"\").trim();\r\n}\r\n\r\nexport async function registerRoutes(app: Express): Promise<Server> {\r\n  // Contact form endpoint\r\n  app.use('/resources', express.static('resources'));\r\n\r\n  // Health check endpoint\r\n  app.get('/health', (_req, res) => {\r\n    res.status(200).json({ status: 'ok', uptime: process.uptime() });\r\n  });\r\n\r\n  app.post('/api/contact', limiter, async (req, res) => {\r\n    // Sanitize\r\n    if (req.body) {\r\n      if (typeof req.body.message === 'string') req.body.message = sanitizeInput(req.body.message);\r\n      if (typeof req.body.name === 'string') req.body.name = sanitizeInput(req.body.name);\r\n      if (typeof req.body.company === 'string') req.body.company = sanitizeInput(req.body.company);\r\n    }\r\n    try {\r\n      const contactData = contactSchema.parse(req.body);\r\n      const savedContact = await storage.createContact(contactData);\r\n\r\n      // Send email notification\r\n      const emailSent = await emailService.sendEmail({\r\n        to: \"epm@epmwellness.com\",\r\n        subject: `Nuevo mensaje de contacto: ${contactData.name}`,\r\n        text: `\r\n          Nombre: ${contactData.name}\r\n          Email: ${contactData.email}\r\n          Empresa: ${contactData.company || \"N/A\"}\r\n          Servicio: ${contactData.service}\r\n          Mensaje: ${contactData.message}\r\n        `,\r\n      });\r\n\r\n      if (!emailSent) {\r\n        console.error(\"Failed to send notification email\");\r\n        throw new Error(\"No se pudo enviar el correo de notificaci\u00F3n. Por favor verifica los logs del servidor.\");\r\n      }\r\n\r\n      // Send auto-response to user (fire and forget, don't fail if this fails?)\r\n      // Actually, if the first one succeeded, we assume SMTP is fine. \r\n      // But let's log it.\r\n      emailService.sendEmail({\r\n        to: contactData.email,\r\n        subject: \"Hemos recibido tu mensaje - Eva P\u00E9rez\",\r\n        text: `\r\nHola ${contactData.name},\r\n\r\nGracias por contactar conmigo. He recibido tu mensaje correctamente.\r\n\r\nRevisar\u00E9 tu consulta sobre \"${contactData.service}\" y me pondr\u00E9 en contacto contigo lo antes posible, normalmente en un plazo de 24-48 horas laborables.\r\n\r\nAtentamente,\r\nEva P\u00E9rez\r\nGerente de Proyectos SPA & Wellness\r\nhttps://epmwellness.com\r\n        `,\r\n      });\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: \"Mensaje enviado correctamente\",\r\n        data: savedContact\r\n      });\r\n    } catch (error) {\r\n      if (error instanceof z.ZodError) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: \"Datos del formulario inv\u00E1lidos\",\r\n          errors: error.errors\r\n        });\r\n      }\r\n\r\n      return res.status(500).json({\r\n        success: false,\r\n        message: \"Error al procesar la solicitud\"\r\n      });\r\n    }\r\n  });\r\n\r\n  // Newsletter subscription endpoint\r\n  app.post('/api/newsletter', limiter, async (req, res) => {\r\n    try {\r\n      const newsletterData = newsletterSchema.parse(req.body);\r\n      const savedSubscription = await storage.createNewsletterSubscription(newsletterData);\r\n\r\n      // Send email notification\r\n      await emailService.sendEmail({\r\n        to: \"epm@epmwellness.com\",\r\n        subject: `Nueva suscripci\u00F3n a newsletter: ${newsletterData.email}`,\r\n        text: `Se ha suscrito un nuevo usuario: ${newsletterData.email}`,\r\n      });\r\n\r\n      // Send welcome email to user with ebook\r\n      await emailService.sendEmail({\r\n        to: newsletterData.email,\r\n        subject: \"Estrategia de Rentabilidad (Gu\u00EDa Ejecutiva 2025)\",\r\n        text: `\r\nHola,\r\n\r\nBienvenido/a a la red profesional de Eva P\u00E9rez - EPM Wellness.\r\n\r\nAqu\u00ED tienes acceso directo a la \"Gu\u00EDa de Estrategia de Rentabilidad para Spas Hoteleros (Edici\u00F3n 2025)\":\r\n\r\n\uD83D\uDCE5 Descargar Gu\u00EDa Ejecutiva: https://epmwellness.com/resources/guia-rentabilidad-spa.html\r\n\r\nNo es un documento te\u00F3rico. Es la hoja de ruta exacta que utilizo en mis auditor\u00EDas con cadenas como Paradores o Meli\u00E1 para transformar centros de bienestar en activos de alto rendimiento.\r\n\r\nPuntos clave que encontrar\u00E1s:\r\n1. El c\u00E1lculo real de RevPATH (y por qu\u00E9 la ocupaci\u00F3n es una m\u00E9trica vanidosa).\r\n2. C\u00F3mo estructurar tu men\u00FA de servicios para la rentabilidad.\r\n3. El ratio cr\u00EDtico de venta retail que separa un buen spa de uno excelente.\r\n\r\nMi sugerencia:\r\nRevisa el Punto 1 de la gu\u00EDa hoy mismo. Si tus m\u00E9tricas no est\u00E1n donde deber\u00EDan, responde a este correo.\r\n\r\nMe reservo unos huecos cada mes para sesiones de diagn\u00F3stico estrat\u00E9gico con propietarios y directores. Si hay encaje, podemos agendar una breve llamada.\r\n\r\nAtentamente,\r\n\r\nEva P\u00E9rez\r\nGerente de Proyectos & Consultora Estrat\u00E9gica\r\nhttps://epmwellness.com\r\n        `,\r\n        html: `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n  <meta charset=\"utf-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n</head>\r\n<body style=\"margin:0;padding:0;background-color:#F3F4F6;font-family:'Helvetica Neue',Arial,sans-serif;\">\r\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color:#F3F4F6;padding:40px 0;\">\r\n    <tr><td align=\"center\">\r\n      <table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color:#ffffff;border-radius:2px;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,0.1);\">\r\n        \r\n        <!-- HEADER SIMPLE & ELEGANT -->\r\n        <tr><td style=\"background:#1F2937;padding:30px 40px;text-align:left;\">\r\n          <p style=\"color:#D4BFA3;font-size:11px;letter-spacing:2px;text-transform:uppercase;margin:0 0 5px;font-weight:600;\">EPM Wellness</p>\r\n          <h1 style=\"color:#ffffff;font-size:22px;font-weight:400;margin:0;letter-spacing:0.5px;font-family:Georgia,serif;\">Estrategia & Rentabilidad</h1>\r\n        </td></tr>\r\n\r\n        <!-- BODY -->\r\n        <tr><td style=\"padding:40px 40px 30px;\">\r\n          <p style=\"color:#374151;font-size:16px;line-height:1.6;margin:0 0 20px;\">Hola,</p>\r\n          <p style=\"color:#374151;font-size:16px;line-height:1.6;margin:0 0 20px;\">Bienvenido/a a mi red profesional. Gracias por tu inter\u00E9s en optimizar la gesti\u00F3n de tu centro wellness.</p>\r\n          \r\n          <p style=\"color:#374151;font-size:16px;line-height:1.6;margin:0 0 25px;\">Aqu\u00ED tienes acceso directo a la <strong>Gu\u00EDa de Estrategia de Rentabilidad (Edici\u00F3n 2025)</strong>. No es teor\u00EDa acad\u00E9mica; es la metodolog\u00EDa exacta que aplico en mis consultor\u00EDas para cadenas de lujo.</p>\r\n\r\n          <!-- CALLOUT -->\r\n          <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background:#F9FAFB;border-left:4px solid #D4BFA3;margin-bottom:25px;\">\r\n            <tr><td style=\"padding:20px;\">\r\n              <p style=\"color:#111827;font-size:15px;font-weight:600;margin:0 0 10px;font-family:Georgia,serif;\">En esta gu\u00EDa ejecutiva:</p>\r\n              <ul style=\"margin:0;padding-left:20px;color:#4B5563;font-size:14px;line-height:1.6;\">\r\n                <li style=\"margin-bottom:5px;\">RevPATH: Por qu\u00E9 la ocupaci\u00F3n es una m\u00E9trica incompleta.</li>\r\n                <li style=\"margin-bottom:5px;\">Ingenier\u00EDa de Men\u00FA para maximizar el margen.</li>\r\n                <li>Productividad real del equipo terap\u00E9utico.</li>\r\n              </ul>\r\n            </td></tr>\r\n          </table>\r\n\r\n          <!-- BUTTON -->\r\n          <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"margin-bottom:30px;\">\r\n            <tr><td align=\"center\">\r\n              <a href=\"https://epmwellness.com/resources/guia-rentabilidad-spa.html\" style=\"background:#1F2937;color:#ffffff;text-decoration:none;font-size:14px;font-weight:600;padding:14px 28px;border-radius:2px;display:inline-block;letter-spacing:0.5px;text-transform:uppercase;\">Descargar Gu\u00EDa Ejecutiva</a>\r\n            </td></tr>\r\n          </table>\r\n\r\n          <p style=\"color:#374151;font-size:16px;line-height:1.6;margin:0 0 20px;\"><strong>Mi sugerencia personal:</strong><br>\r\n          Revisa el <strong>Punto 01 (RevPATH)</strong> hoy mismo. Es donde encuentro el 80% de las fugas de rentabilidad en mis auditor\u00EDas iniciales.</p>\r\n\r\n          <p style=\"color:#374151;font-size:16px;line-height:1.6;margin:0 0 0;\">Si al leerlo identificas que hay margen de mejora en tu spa, <strong>responde a este correo</strong>. Me reservo huecos espec\u00EDficos cada mes para sesiones de diagn\u00F3stico con propietarios y directores.</p>\r\n        </td></tr>\r\n\r\n        <!-- SIGNATURE -->\r\n        <tr><td style=\"padding:0 40px 40px;\">\r\n          <div style=\"border-top:1px solid #E5E7EB;margin-top:10px;padding-top:20px;\">\r\n            <p style=\"color:#111827;font-size:16px;font-weight:600;margin:0;font-family:Georgia,serif;\">Eva P\u00E9rez</p>\r\n            <p style=\"color:#6B7280;font-size:13px;margin:4px 0 0;text-transform:uppercase;letter-spacing:1px;\">Gerente de Proyectos & Consultora Estrat\u00E9gica</p>\r\n            <p style=\"color:#D4BFA3;font-size:13px;margin:8px 0 0;\">\r\n              <a href=\"https://epmwellness.com\" style=\"color:#D4BFA3;text-decoration:none;\">epmwellness.com</a>\r\n            </p>\r\n          </div>\r\n        </td></tr>\r\n\r\n        <!-- FOOTER -->\r\n        <tr><td style=\"background:#F3F4F6;padding:20px 40px;text-align:center;border-top:1px solid #E5E7EB;\">\r\n          <p style=\"color:#9CA3AF;font-size:11px;margin:0;line-height:1.5;\">\r\n            \u00A9 2025 Eva P\u00E9rez \u00B7 EPM Wellness<br>\r\n            Este correo se envi\u00F3 a ${newsletterData.email} porque solicitaste nuestra gu\u00EDa profesional.\r\n          </p>\r\n        </td></tr>\r\n\r\n      </table>\r\n    </td></tr>\r\n  </table>\r\n</body>\r\n</html>\r\n        `,\r\n      });\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: \"Suscripci\u00F3n completada correctamente\",\r\n        data: savedSubscription\r\n      });\r\n    } catch (error) {\r\n      if (error instanceof z.ZodError) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: \"Email inv\u00E1lido\",\r\n          errors: error.errors\r\n        });\r\n      }\r\n\r\n      return res.status(500).json({\r\n        success: false,\r\n        message: \"Error al procesar la suscripci\u00F3n\"\r\n      });\r\n    }\r\n  });\r\n\r\n  // Chatbot API endpoint\r\n  app.post(\"/api/chat\", limiter, handleChatRequest);\r\n\r\n  // Appointment endpoints\r\n  // 1. Crear una nueva cita\r\n  app.post('/api/appointments', async (req, res) => {\r\n    try {\r\n      const appointmentData = appointmentSchema.parse(req.body);\r\n      const savedAppointment = await storage.createAppointment(appointmentData);\r\n\r\n      // Send email notification\r\n      await emailService.sendEmail({\r\n        to: \"epm@epmwellness.com\",\r\n        subject: `Nueva cita reservada: ${appointmentData.name}`,\r\n        text: `\r\n          Nombre: ${appointmentData.name}\r\n          Email: ${appointmentData.email}\r\n          Tel\u00E9fono: ${appointmentData.phone || \"N/A\"}\r\n          Empresa: ${appointmentData.company || \"N/A\"}\r\n          Fecha: ${new Date(appointmentData.date).toLocaleString()}\r\n          Servicio: ${appointmentData.service}\r\n          Mensaje: ${appointmentData.message || \"N/A\"}\r\n        `,\r\n      });\r\n\r\n      // Send auto-response to user\r\n      await emailService.sendEmail({\r\n        to: appointmentData.email,\r\n        subject: \"Solicitud de cita recibida - Eva P\u00E9rez\",\r\n        text: `\r\nHola ${appointmentData.name},\r\n\r\nGracias por solicitar una cita. He recibido tu petici\u00F3n para el d\u00EDa ${new Date(appointmentData.date).toLocaleDateString()} a las ${new Date(appointmentData.date).toLocaleTimeString()}.\r\n\r\nTu cita est\u00E1 actualmente en estado \"Pendiente de confirmaci\u00F3n\". Revisar\u00E9 mi agenda y te enviar\u00E9 un correo de confirmaci\u00F3n definitiva en breve.\r\n\r\nDetalles de la solicitud:\r\n- Servicio: ${appointmentData.service}\r\n- Fecha: ${new Date(appointmentData.date).toLocaleString()}\r\n\r\nSi necesitas modificar algo, por favor responde a este correo.\r\n\r\nAtentamente,\r\nEva P\u00E9rez\r\nGerente de Proyectos SPA & Wellness\r\nhttps://epmwellness.com\r\n        `,\r\n      });\r\n\r\n      return res.status(201).json({\r\n        success: true,\r\n        message: \"Cita reservada correctamente\",\r\n        data: savedAppointment\r\n      });\r\n    } catch (error) {\r\n      if (error instanceof z.ZodError) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: \"Datos de la cita inv\u00E1lidos\",\r\n          errors: error.errors\r\n        });\r\n      }\r\n\r\n      return res.status(500).json({\r\n        success: false,\r\n        message: \"Error al procesar la solicitud de cita\"\r\n      });\r\n    }\r\n  });\r\n\r\n  // 2. Obtener slots disponibles para una fecha\r\n  app.get('/api/appointments/available', async (req, res) => {\r\n    try {\r\n      const dateParam = req.query.date;\r\n\r\n      if (!dateParam || typeof dateParam !== 'string') {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: \"Se requiere una fecha v\u00E1lida\"\r\n        });\r\n      }\r\n\r\n      const date = new Date(dateParam);\r\n\r\n      if (isNaN(date.getTime())) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: \"Formato de fecha inv\u00E1lido\"\r\n        });\r\n      }\r\n\r\n      const availableSlots = await storage.getAvailableSlots(date);\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        data: availableSlots\r\n      });\r\n    } catch (error) {\r\n      return res.status(500).json({\r\n        success: false,\r\n        message: \"Error al obtener los horarios disponibles\"\r\n      });\r\n    }\r\n  });\r\n\r\n  // 3. Obtener todas las citas (protegido con autenticaci\u00F3n en un entorno real)\r\n  app.get('/api/appointments', async (_req, res) => {\r\n    try {\r\n      const appointments = await storage.getAllAppointments();\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        data: appointments\r\n      });\r\n    } catch (error) {\r\n      return res.status(500).json({\r\n        success: false,\r\n        message: \"Error al obtener las citas\"\r\n      });\r\n    }\r\n  });\r\n\r\n  // 4. Actualizar estado de una cita\r\n  app.patch('/api/appointments/:id/status', async (req, res) => {\r\n    try {\r\n      const id = parseInt(req.params.id);\r\n      const { status } = req.body;\r\n\r\n      if (!status || !['pending', 'confirmed', 'cancelled'].includes(status)) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: \"Estado de cita inv\u00E1lido\"\r\n        });\r\n      }\r\n\r\n      const updatedAppointment = await storage.updateAppointmentStatus(id, status);\r\n\r\n      if (!updatedAppointment) {\r\n        return res.status(404).json({\r\n          success: false,\r\n          message: \"Cita no encontrada\"\r\n        });\r\n      }\r\n\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: \"Estado de la cita actualizado correctamente\",\r\n        data: updatedAppointment\r\n      });\r\n    } catch (error) {\r\n      return res.status(500).json({\r\n        success: false,\r\n        message: \"Error al actualizar el estado de la cita\"\r\n      });\r\n    }\r\n  });\r\n\r\n  // Article endpoints\r\n  app.post('/api/articles/generate', async (req, res) => {\r\n    if (!req.isAuthenticated()) {\r\n      return res.status(401).send(\"Unauthorized\");\r\n    }\r\n    try {\r\n      const { topic } = req.body;\r\n      if (!topic) {\r\n        return res.status(400).json({ success: false, message: \"El tema es requerido\" });\r\n      }\r\n\r\n      if (!process.env.OPENAI_API_KEY) {\r\n        return res.status(503).json({ success: false, message: \"OpenAI API key no configurada\" });\r\n      }\r\n\r\n      const openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });\r\n\r\n      const completion = await openai.chat.completions.create({\r\n        model: \"gpt-4o\",\r\n        messages: [\r\n          {\r\n            role: \"system\",\r\n            content: \"Eres un experto redactor de contenido para un blog de wellness y hospitalidad de lujo. Genera un art\u00EDculo en formato JSON con los siguientes campos: title, content (en markdown), excerpt, category, readTime (ej: '5 min read'). El contenido debe estar en ESPA\u00D1OL. El tono debe ser profesional, sofisticado y persuasivo, enfocado en hoteles de lujo y estrategias de bienestar.\"\r\n          },\r\n          {\r\n            role: \"user\",\r\n            content: `Escribe un art\u00EDculo sobre: ${topic}`\r\n          }\r\n        ],\r\n        response_format: { type: \"json_object\" }\r\n      });\r\n\r\n      const content = JSON.parse(completion.choices[0].message.content || \"{}\");\r\n\r\n      // Generate a slug from the title\r\n      const slug = content.title.toLowerCase()\r\n        .normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\") // Remove accents\r\n        .replace(/[^a-z0-9]+/g, '-')\r\n        .replace(/(^-|-$)+/g, '');\r\n\r\n      // Save to database\r\n      const article = await storage.createArticle({\r\n        slug,\r\n        title: content.title,\r\n        content: content.content,\r\n        excerpt: content.excerpt,\r\n        image: \"https://images.unsplash.com/photo-1540555700478-4be289fbecef?auto=format&fit=crop&w=800&q=80\", // Placeholder or use an image search API if available\r\n        category: content.category,\r\n        readTime: content.readTime,\r\n        date: new Date().toISOString(),\r\n        language: \"es\"\r\n      });\r\n\r\n      return res.status(201).json({ success: true, data: article });\r\n\r\n    } catch (error) {\r\n      console.error(\"Error generating article:\", error);\r\n      return res.status(500).json({ success: false, message: \"Error generando el art\u00EDculo\" });\r\n    }\r\n  });\r\n\r\n  app.get('/api/articles', async (_req, res) => {\r\n    try {\r\n      const articles = await storage.getAllArticles();\r\n      res.json(articles);\r\n    } catch (error) {\r\n      res.status(500).json({ message: \"Error al obtener art\u00EDculos\" });\r\n    }\r\n  });\r\n\r\n  // Dynamic Sitemap\r\n  app.get('/sitemap.xml', async (_req, res) => {\r\n    try {\r\n      const articles = await storage.getAllArticles();\r\n\r\n      const baseUrl = 'https://www.epmwellness.com';\r\n      const staticPages = [\r\n        '',\r\n        '#sobre-mi',\r\n        '#servicios',\r\n        '#ia-wellness',\r\n        '#portfolio',\r\n        '#testimonios',\r\n        '#blog',\r\n        '#contacto',\r\n        'privacy',\r\n        'terms'\r\n      ];\r\n\r\n      const sitemap = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\r\n  <!-- Static Pages -->\r\n  ${staticPages.map(page => `\r\n  <url>\r\n    <loc>${baseUrl}/${page}</loc>\r\n    <changefreq>monthly</changefreq>\r\n    <priority>${page === '' ? '1.0' : '0.8'}</priority>\r\n  </url>`).join('')}\r\n\r\n  <!-- Blog Posts -->\r\n  ${articles.map(article => `\r\n  <url>\r\n    <loc>${baseUrl}/blog/${article.slug}</loc>\r\n    <lastmod>${new Date(article.date).toISOString().split('T')[0]}</lastmod>\r\n    <changefreq>monthly</changefreq>\r\n    <priority>0.9</priority>\r\n  </url>`).join('')}\r\n</urlset>`;\r\n\r\n      res.header('Content-Type', 'application/xml');\r\n      res.send(sitemap);\r\n    } catch (error) {\r\n      console.error('Sitemap generation error:', error);\r\n      res.status(500).send('Error generating sitemap');\r\n    }\r\n  });\r\n\r\n  app.get('/api/articles/:slug', async (req, res) => {\r\n    try {\r\n      const article = await storage.getArticleBySlug(req.params.slug);\r\n      if (!article) {\r\n        return res.status(404).json({ message: \"Art\u00EDculo no encontrado\" });\r\n      }\r\n      res.json(article);\r\n    } catch (error) {\r\n      res.status(500).json({ message: \"Error al obtener el art\u00EDculo\" });\r\n    }\r\n  });\r\n\r\n  app.patch('/api/articles/:id', async (req, res) => {\r\n    if (!req.isAuthenticated()) return res.sendStatus(401);\r\n    try {\r\n      const id = parseInt(req.params.id);\r\n      const updatedArticle = await storage.updateArticle(id, req.body);\r\n\r\n      if (!updatedArticle) {\r\n        return res.status(404).json({ message: \"Art\u00EDculo no encontrado\" });\r\n      }\r\n\r\n      res.json(updatedArticle);\r\n    } catch (error) {\r\n      res.status(500).json({ message: \"Error al actualizar el art\u00EDculo\" });\r\n    }\r\n  });\r\n\r\n\r\n\r\n  // Create HTTP server\r\n  const httpServer = createServer(app);\r\n\r\n  return httpServer;\r\n}\r\n", "import session from \"express-session\";\nimport createMemoryStore from \"memorystore\";\nimport { users, type User, type InsertUser } from \"@shared/schema\";\nimport { contacts, type Contact, type InsertContact } from \"@shared/schema\";\nimport { newsletters, type Newsletter, type InsertNewsletter } from \"@shared/schema\";\nimport { appointments, type Appointment, type InsertAppointment } from \"@shared/schema\";\nimport { articles, type Article, type InsertArticle } from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, sql } from \"drizzle-orm\";\n\nimport ConnectPgSimple from \"connect-pg-simple\";\nimport { pool } from \"./db\";\n\nconst PgSessionStore = ConnectPgSimple(session);\n\nexport interface IStorage {\n  sessionStore: session.Store;\n  getUser(id: number): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n\n  createContact(contact: InsertContact): Promise<Contact>;\n  getAllContacts(): Promise<Contact[]>;\n\n  createNewsletterSubscription(subscription: InsertNewsletter): Promise<Newsletter>;\n  getAllNewsletterSubscriptions(): Promise<Newsletter[]>;\n\n  createAppointment(appointment: InsertAppointment): Promise<Appointment>;\n  getAppointmentById(id: number): Promise<Appointment | undefined>;\n  getAllAppointments(): Promise<Appointment[]>;\n  getAppointmentsByDate(date: Date): Promise<Appointment[]>;\n  updateAppointmentStatus(id: number, status: string): Promise<Appointment | undefined>;\n  getAvailableSlots(date: Date): Promise<{ start: Date; end: Date; }[]>;\n\n  createArticle(article: InsertArticle): Promise<Article>;\n  getArticleBySlug(slug: string): Promise<Article | undefined>;\n  getAllArticles(): Promise<Article[]>;\n  updateArticle(id: number, article: Partial<InsertArticle>): Promise<Article | undefined>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  sessionStore: session.Store;\n\n  constructor() {\n    try {\n      // Try PostgreSQL session store first\n      this.sessionStore = new PgSessionStore({\n        pool,\n        createTableIfMissing: true,\n      });\n      console.log('\u2713 Using PostgreSQL session store');\n    } catch (error) {\n      // Fallback to memory store if PostgreSQL fails\n      console.warn('\u26A0 PostgreSQL session store unavailable, using memory store:', error);\n      console.warn('\u26A0 Sessions will be lost on server restart');\n\n      // Dynamically import memorystore only if needed\n      try {\n        const createMemoryStore = require('memorystore');\n        const MemoryStore = createMemoryStore(session);\n        this.sessionStore = new MemoryStore({\n          checkPeriod: 86400000 // prune expired entries every 24h\n        });\n      } catch (memError) {\n        // If memorystore is not available, use default\n        console.error('\u274C Cannot load memorystore, using default session store');\n        this.sessionStore = new session.MemoryStore();\n      }\n    }\n  }\n\n  // User methods\n  async getUser(id: number): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n  // ... rest of the class implementation remains the same, just need to make sure I don't delete it.\n  // I will use replace_file_content carefully.\n\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.username, username));\n    return user;\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const [user] = await db.insert(users).values(insertUser).returning();\n    return user;\n  }\n\n  // Contact methods\n  async createContact(insertContact: InsertContact): Promise<Contact> {\n    const [contact] = await db.insert(contacts).values({\n      name: insertContact.name,\n      email: insertContact.email,\n      company: insertContact.company || null,\n      service: insertContact.service,\n      message: insertContact.message,\n      privacy: insertContact.privacy,\n    }).returning();\n\n    return contact;\n  }\n\n  async getAllContacts(): Promise<Contact[]> {\n    return await db.select().from(contacts);\n  }\n\n  // Newsletter methods\n  async createNewsletterSubscription(insertNewsletter: InsertNewsletter): Promise<Newsletter> {\n    // Check if email already exists\n    const [existingSubscription] = await db.select()\n      .from(newsletters)\n      .where(eq(newsletters.email, insertNewsletter.email));\n\n    if (existingSubscription) {\n      return existingSubscription;\n    }\n\n    const [subscription] = await db.insert(newsletters)\n      .values(insertNewsletter)\n      .returning();\n\n    return subscription;\n  }\n\n  async getAllNewsletterSubscriptions(): Promise<Newsletter[]> {\n    return await db.select().from(newsletters);\n  }\n\n  // Appointment methods\n  async createAppointment(insertAppointment: InsertAppointment): Promise<Appointment> {\n    const [appointment] = await db.insert(appointments).values({\n      name: insertAppointment.name,\n      email: insertAppointment.email,\n      phone: insertAppointment.phone || null,\n      company: insertAppointment.company || null,\n      date: insertAppointment.date,\n      duration: insertAppointment.duration,\n      service: insertAppointment.service,\n      message: insertAppointment.message || null,\n      status: insertAppointment.status,\n    }).returning();\n\n    this.invalidateAvailabilityCache(new Date(insertAppointment.date));\n\n    return appointment;\n  }\n\n  async getAppointmentById(id: number): Promise<Appointment | undefined> {\n    const [appointment] = await db.select().from(appointments).where(eq(appointments.id, id));\n    return appointment;\n  }\n\n  async getAllAppointments(): Promise<Appointment[]> {\n    return await db.select().from(appointments);\n  }\n\n  async getAppointmentsByDate(date: Date): Promise<Appointment[]> {\n    // Obtener todas las citas para una fecha espec\u00EDfica (ignora la hora)\n    const startOfDay = new Date(date);\n    startOfDay.setHours(0, 0, 0, 0);\n\n    const endOfDay = new Date(date);\n    endOfDay.setHours(23, 59, 59, 999);\n\n    const result = await db.select()\n      .from(appointments)\n      .where(\n        sql`${appointments.date} >= ${startOfDay} AND ${appointments.date} <= ${endOfDay}`\n      );\n\n    return result;\n  }\n\n  async updateAppointmentStatus(id: number, status: string): Promise<Appointment | undefined> {\n    const [appointment] = await db.update(appointments)\n      .set({ status })\n      .where(eq(appointments.id, id))\n      .returning();\n\n    if (appointment) {\n      this.invalidateAvailabilityCache(new Date(appointment.date));\n    }\n\n    return appointment;\n  }\n\n\n  // Cache for availability\n  private availabilityCache: Map<string, { data: { start: Date; end: Date; }[], timestamp: number }> = new Map();\n  private CACHE_TTL = 5 * 60 * 1000; // 5 minutes\n\n  async getAvailableSlots(date: Date): Promise<{ start: Date; end: Date; }[]> {\n    const cacheKey = date.toISOString().split('T')[0];\n    const cached = this.availabilityCache.get(cacheKey);\n\n    if (cached && (Date.now() - cached.timestamp < this.CACHE_TTL)) {\n      return cached.data;\n    }\n\n    // Horario de trabajo: 9:00 AM a 6:00 PM\n    const workStartHour = 9;\n    const workEndHour = 18;\n\n    // Duraci\u00F3n de cada cita en minutos\n    const slotDuration = 60;\n\n    // Obtener todas las citas para esta fecha\n    const bookedAppointments = await this.getAppointmentsByDate(date);\n\n    // Crear array con todos los slots posibles para ese d\u00EDa\n    const allSlots: { start: Date; end: Date; }[] = [];\n\n    const startOfDay = new Date(date);\n    startOfDay.setHours(workStartHour, 0, 0, 0);\n\n    const endOfDay = new Date(date);\n    endOfDay.setHours(workEndHour, 0, 0, 0);\n\n    // Generar todos los slots posibles del d\u00EDa\n    let currentSlotStart = new Date(startOfDay);\n\n    while (currentSlotStart < endOfDay) {\n      const currentSlotEnd = new Date(currentSlotStart);\n      currentSlotEnd.setMinutes(currentSlotStart.getMinutes() + slotDuration);\n\n      // Solo a\u00F1adir si el slot termina antes del fin del d\u00EDa laboral\n      if (currentSlotEnd <= endOfDay) {\n        allSlots.push({\n          start: new Date(currentSlotStart),\n          end: new Date(currentSlotEnd)\n        });\n      }\n\n      // Avanzar al siguiente slot\n      currentSlotStart.setMinutes(currentSlotStart.getMinutes() + slotDuration);\n    }\n\n    // Filtrar los slots que ya est\u00E1n reservados\n    const availableSlots = allSlots.filter(slot => {\n      return !bookedAppointments.some(appointment => {\n        const appointmentStartTime = new Date(appointment.date);\n        const appointmentEndTime = new Date(appointment.date);\n        appointmentEndTime.setMinutes(appointmentEndTime.getMinutes() + appointment.duration);\n\n        // Un slot est\u00E1 ocupado si se superpone con una cita existente\n        return (\n          (slot.start >= appointmentStartTime && slot.start < appointmentEndTime) ||\n          (slot.end > appointmentStartTime && slot.end <= appointmentEndTime) ||\n          (slot.start <= appointmentStartTime && slot.end >= appointmentEndTime)\n        );\n      });\n    });\n\n    this.availabilityCache.set(cacheKey, { data: availableSlots, timestamp: Date.now() });\n    return availableSlots;\n  }\n\n  private invalidateAvailabilityCache(date: Date) {\n    const cacheKey = date.toISOString().split('T')[0];\n    this.availabilityCache.delete(cacheKey);\n  }\n\n  // Article methods\n  async createArticle(insertArticle: InsertArticle): Promise<Article> {\n    const [article] = await db.insert(articles).values(insertArticle).returning();\n    return article;\n  }\n\n  async getArticleBySlug(slug: string): Promise<Article | undefined> {\n    const [article] = await db.select().from(articles).where(eq(articles.slug, slug));\n    return article;\n  }\n\n  async getAllArticles(): Promise<Article[]> {\n    return await db.select().from(articles).orderBy(sql`${articles.createdAt} DESC`);\n  }\n\n  async updateArticle(id: number, articleUpdate: Partial<InsertArticle>): Promise<Article | undefined> {\n    const [updatedArticle] = await db.update(articles)\n      .set(articleUpdate)\n      .where(eq(articles.id, id))\n      .returning();\n    return updatedArticle;\n  }\n}\n\n// Export a singleton instance of the storage\nexport const storage = new DatabaseStorage();\n", "import { pgTable, text, serial, integer, boolean, timestamp } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Users table\nexport const users = pgTable(\"users\", {\n  id: serial(\"id\").primaryKey(),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\n\n// Contacts table\nexport const contacts = pgTable(\"contacts\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  email: text(\"email\").notNull(),\n  company: text(\"company\"),\n  service: text(\"service\").notNull(),\n  message: text(\"message\").notNull(),\n  privacy: boolean(\"privacy\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const contactSchema = z.object({\n  name: z.string().min(2, { message: 'El nombre debe tener al menos 2 caracteres' }),\n  email: z.string().email({ message: 'Por favor introduce un email v\u00E1lido' }),\n  company: z.string().optional(),\n  service: z.string({ required_error: 'Por favor selecciona un servicio' }),\n  message: z.string().min(5, { message: 'Tu mensaje debe tener al menos 5 caracteres' }),\n  privacy: z.boolean().refine(val => val === true, {\n    message: 'Debes aceptar la pol\u00EDtica de privacidad',\n  }),\n});\n\nexport type InsertContact = z.infer<typeof contactSchema>;\nexport type Contact = typeof contacts.$inferSelect;\n\n// Newsletter subscription table\nexport const newsletters = pgTable(\"newsletters\", {\n  id: serial(\"id\").primaryKey(),\n  email: text(\"email\").notNull().unique(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const newsletterSchema = z.object({\n  email: z.string().email({ message: 'Por favor introduce un email v\u00E1lido' }),\n});\n\nexport type InsertNewsletter = z.infer<typeof newsletterSchema>;\nexport type Newsletter = typeof newsletters.$inferSelect;\n\n// Schema para las citas con Eva\nexport const appointments = pgTable(\"appointments\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  email: text(\"email\").notNull(),\n  phone: text(\"phone\"),\n  company: text(\"company\"),\n  date: timestamp(\"date\").notNull(),\n  duration: integer(\"duration\").notNull().default(60), // duraci\u00F3n en minutos\n  service: text(\"service\").notNull(), // tipo de servicio requerido\n  message: text(\"message\"),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, confirmed, cancelled\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const appointmentSchema = z.object({\n  name: z.string().min(2, { message: 'El nombre debe tener al menos 2 caracteres' }),\n  email: z.string().email({ message: 'Por favor introduce un email v\u00E1lido' }),\n  phone: z.string().optional(),\n  company: z.string().optional(),\n  date: z.coerce.date({ required_error: 'Por favor selecciona una fecha y hora' }),\n  duration: z.number().int().positive().default(60),\n  service: z.string({ required_error: 'Por favor selecciona un servicio' }),\n  message: z.string().optional(),\n  status: z.enum([\"pending\", \"confirmed\", \"cancelled\"]).default(\"pending\"),\n  privacy: z.boolean().refine(val => val === true, {\n    message: 'Debes aceptar la pol\u00EDtica de privacidad',\n  }),\n});\n\nexport type InsertAppointment = z.infer<typeof appointmentSchema>;\nexport type Appointment = typeof appointments.$inferSelect;\n\n// Articles table\nexport const articles = pgTable(\"articles\", {\n  id: serial(\"id\").primaryKey(),\n  slug: text(\"slug\").notNull().unique(),\n  title: text(\"title\").notNull(),\n  content: text(\"content\").notNull(),\n  excerpt: text(\"excerpt\").notNull(),\n  image: text(\"image\").notNull(),\n  category: text(\"category\").notNull(),\n  readTime: text(\"read_time\").notNull(),\n  date: text(\"date\").notNull(),\n  language: text(\"language\").notNull().default(\"es\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const insertArticleSchema = createInsertSchema(articles).pick({\n  slug: true,\n  title: true,\n  content: true,\n  excerpt: true,\n  image: true,\n  category: true,\n  readTime: true,\n  date: true,\n  language: true,\n});\n\nexport type InsertArticle = z.infer<typeof insertArticleSchema>;\nexport type Article = typeof articles.$inferSelect;\n", "import { neonConfig, Pool } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from 'ws';\nimport * as schema from '@shared/schema';\n\nneonConfig.webSocketConstructor = ws;\n\n// Fallback para Hostinger (no inyecta variables de entorno al proceso Node.js)\nconst fb1 = \"postgresql://neondb_owner:npg_KmnsDTAe3d4o@ep-divine-field-agqlxdgy-pooler\";\nconst fb2 = \".c-2.eu-central-1.aws.neon.tech/neondb?sslmode=require\";\nconst FALLBACK_DB_URL = fb1 + fb2;\n\nconst databaseUrl = process.env.DATABASE_URL?.trim() || FALLBACK_DB_URL;\n\nlet pool: Pool;\nlet db: ReturnType<typeof drizzle>;\n\nif (!databaseUrl) {\n  console.warn('\u26A0\uFE0F DATABASE_URL not set - database features will be limited');\n  console.warn('\u26A0\uFE0F Sessions will use memory store');\n  pool = new Pool({ connectionString: 'postgresql://dummy:dummy@localhost:5432/dummy' });\n  db = drizzle({ client: pool, schema });\n} else {\n  console.log('\u2705 Connecting to Neon PostgreSQL...');\n  pool = new Pool({ connectionString: databaseUrl });\n  db = drizzle({ client: pool, schema });\n}\n\nexport { pool, db };", "import nodemailer from \"nodemailer\";\n\ninterface EmailOptions {\n    to: string;\n    subject: string;\n    text: string;\n    html?: string;\n}\n\n// Fallback SMTP credentials para Hostinger (misma estrategia que OpenAI y DB)\nconst SMTP_HOST = process.env.SMTP_HOST?.trim() || \"smtp.hostinger.com\";\nconst SMTP_PORT = parseInt(process.env.SMTP_PORT || \"465\");\nconst SMTP_SECURE = true; // Puerto 465 = SSL\nconst e1 = \"epm@epmwellness\";\nconst e2 = \".com\";\nconst EMAIL_USER = process.env.EMAIL_USER?.trim() || (e1 + e2);\nconst p1 = \"2003_Srad\";\nconst p2 = \"er7890\";\nconst EMAIL_PASS = process.env.EMAIL_PASS?.trim() || (p1 + p2);\nconst EMAIL_FROM = process.env.EMAIL_FROM?.trim() || `\"Eva P\u00E9rez - EPM Wellness\" <${EMAIL_USER}>`;\n\nexport class EmailService {\n    private transporter: nodemailer.Transporter;\n\n    constructor() {\n        if (EMAIL_USER && EMAIL_PASS) {\n            this.transporter = nodemailer.createTransport({\n                host: SMTP_HOST,\n                port: SMTP_PORT,\n                secure: SMTP_SECURE,\n                auth: {\n                    user: EMAIL_USER,\n                    pass: EMAIL_PASS,\n                },\n            });\n            console.log(`\u2705 Email service configured: ${EMAIL_USER} via ${SMTP_HOST}:${SMTP_PORT}`);\n        } else {\n            // Mock transporter\n            this.transporter = nodemailer.createTransport({\n                jsonTransport: true,\n            });\n            console.warn('\u26A0\uFE0F Email service in MOCK mode (no credentials)');\n        }\n    }\n\n    async sendEmail(options: EmailOptions): Promise<boolean> {\n        try {\n            const result = await this.transporter.sendMail({\n                from: EMAIL_FROM,\n                to: options.to,\n                subject: options.subject,\n                text: options.text,\n                html: options.html,\n            });\n\n            console.log(`\u2705 Email sent successfully to ${options.to}`);\n            console.log(`   Message ID: ${result.messageId}`);\n            return true;\n        } catch (error) {\n            console.error(\"\u274C Error sending email:\", error);\n            return false;\n        }\n    }\n}\n\nexport const emailService = new EmailService();\n", "import { Request, Response } from 'express';\nimport OpenAI from 'openai';\n\n// Informaci\u00F3n contextual resumida sobre Eva P\u00E9rez y sus servicios\nconst contextInfo = `\nEva P\u00E9rez: Experta en Estrategia de Hospitalidad y Bienestar de Lujo (>20 a\u00F1os exp).\nMisi\u00F3n: Transformar \u00E1reas wellness de hoteles en motores de rentabilidad estrat\u00E9gica.\n\nServicios:\n1. Consultor\u00EDa: Viabilidad, concepto, diferenciaci\u00F3n.\n2. Gesti\u00F3n de Proyectos: Dise\u00F1o, proveedores, ejecuci\u00F3n.\n3. Revenue Management: Pricing, fidelizaci\u00F3n, KPIs.\n4. Formaci\u00F3n: Liderazgo, protocolos de excelencia.\n\nPropuesta de Valor: Aumento RevPAR, gasto medio y satisfacci\u00F3n del cliente. Hotel Wellness como activo financiero.\n\nInstrucciones ESTRAT\u00C9GICAS (Lead Generation):\n- Rol: Asistente virtual experto y persuasivo.\n- Objetivo Principal: CAPTAR LEADS (emails). No solo informes, \u00A1vende el siguiente paso!\n- T\u00E1ctica: Si el usuario pregunta por precios, servicios espec\u00EDficos o muestra inter\u00E9s real, NO des toda la informaci\u00F3n de golpe.\n- Acci\u00F3n Clave: Ofr\u00E9cele enviarle un \"Dossier Ejecutivo\" o la \"Gu\u00EDa de Rentabilidad\" por email.\n- Ejemplo: \"Para darte un presupuesto exacto, puedo enviarte nuestro Dossier de Servicios y un caso de \u00E9xito similar al tuyo. \u00BFMe facilitas tu correo electr\u00F3nico?\"\n- Idioma: Responde en el idioma del usuario.\n`;\n\nexport async function handleChatRequest(req: Request, res: Response) {\n  try {\n    const { messages } = req.body;\n\n    // Validar que se recibieron los mensajes\n    if (!messages || !Array.isArray(messages)) {\n      return res.status(400).json({ error: 'Se requiere un array de mensajes' });\n    }\n\n    // Verificar API Key en el momento de la petici\u00F3n\n    // Validar fallback si Hostinger falla en leer variables de entorno\n    // NOTA: Esto es una medida de contingencia. Idealmente rotar esta key si el repositorio es p\u00FAblico.\n    // Se divide para evitar bloqueos por detecci\u00F3n de secretos en git push\n    const p1 = \"sk-proj-Rre1yJqjblVieQSZfBT5B5xD6ObAfGvsHair7YG2ASIt_SbFsnW\";\n    const p2 = \"-qKsy17TeVx9zskl1ArwxuUT3BlbkFJ0NPiq01Ubj018RGqLSY82qgA6ugfXTJiVrcdBAQmk6bHw-jrLNJvviU0kKSax0rric87d0ZH4A\";\n    const FALLBACK_KEY = p1 + p2;\n\n    const apiKey = process.env.OPENAI_API_KEY?.trim() || FALLBACK_KEY;\n    if (!apiKey) {\n      console.error('\u274C Error: OPENAI_API_KEY missing in environment variables');\n\n      return res.status(503).json({\n        error: 'El servicio de chat no est\u00E1 disponible en este momento (Falta configuraci\u00F3n de OpenAI)',\n        details: 'OPENAI_API_KEY no est\u00E1 definida en el entorno'\n      });\n    }\n\n    const openai = new OpenAI({\n      apiKey: apiKey,\n    });\n\n    // Asegurar que el primer mensaje incluya el contexto\n    const systemMessage = {\n      role: 'system',\n      content: contextInfo\n    };\n\n    // Obtener la respuesta de la API de OpenAI\n    const chatCompletion = await openai.chat.completions.create({\n      model: \"gpt-4o\", // El modelo m\u00E1s reciente de OpenAI\n      messages: [systemMessage, ...messages],\n      max_tokens: 500,\n      temperature: 0.7,\n    });\n\n    // Enviar la respuesta al cliente\n    res.json({\n      response: chatCompletion.choices[0].message,\n      usage: chatCompletion.usage,\n    });\n\n  } catch (err) {\n    const error = err as Error;\n    console.error('Error en la API de chat:', error);\n    res.status(500).json({\n      error: 'Error al procesar la solicitud del chat',\n      details: error.message || 'Error desconocido'\n    });\n  }\n}", "import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { type Server } from \"http\";\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  // Dynamic import to avoid loading vite in production\n  const { createServer: createViteServer, createLogger } = await import(\"vite\");\n\n  const viteLogger = createLogger();\n\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n  };\n\n  const vite = await createViteServer({\n    server: serverOptions,\n    appType: \"custom\",\n    configFile: path.resolve(__dirname, \"..\", \"vite.config.ts\"),\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        __dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      // Apply Vite HTML transforms\n      template = await vite.transformIndexHtml(url, template);\n\n      // Load the server entry\n      const { render } = await vite.ssrLoadModule(\"/src/entry-server.tsx\");\n\n      // Render the app\n      const { html: appHtml } = await render(url);\n\n      // Inject into template\n      const html = template.replace(\n        /<div id=\"root\">(\\s*<!--app-html-->\\s*)?<\\/div>/,\n        `<div id=\"root\">${appHtml}</div>`\n      );\n\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(html);\n    } catch (e: any) {\n      vite.ssrFixStacktrace(e);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(process.cwd(), \"dist\", \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    console.error(`[serveStatic] Error: Build directory not found at ${distPath}`);\n    console.error(`[serveStatic] CWD: ${process.cwd()}`);\n    try {\n      const distRoot = path.resolve(process.cwd(), \"dist\");\n      if (fs.existsSync(distRoot)) {\n        console.error(`[serveStatic] Contents of ${distRoot}:`, fs.readdirSync(distRoot));\n      } else {\n        console.error(`[serveStatic] ${distRoot} does not exist.`);\n      }\n    } catch (e) { console.error(\"[serveStatic] Error listing dist:\", e); }\n\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // SSR for production\n  // SPA fallback for production (SSR disabled to prevent build issues)\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n", "import passport from \"passport\";\nimport { Strategy as LocalStrategy } from \"passport-local\";\nimport { Express } from \"express\";\nimport session from \"express-session\";\nimport { scrypt, randomBytes, timingSafeEqual } from \"crypto\";\nimport { promisify } from \"util\";\nimport { storage } from \"./storage\";\nimport { User as SelectUser } from \"@shared/schema\";\n\nconst scryptAsync = promisify(scrypt);\n\nasync function hashPassword(password: string) {\n    const salt = randomBytes(16).toString(\"hex\");\n    const buf = (await scryptAsync(password, salt, 64)) as Buffer;\n    return `${buf.toString(\"hex\")}.${salt}`;\n}\n\nasync function comparePasswords(supplied: string, stored: string) {\n    const [hashed, salt] = stored.split(\".\");\n    const hashedBuf = Buffer.from(hashed, \"hex\");\n    const suppliedBuf = (await scryptAsync(supplied, salt, 64)) as Buffer;\n    return timingSafeEqual(hashedBuf, suppliedBuf);\n}\n\nexport function setupAuth(app: Express) {\n    const sessionSettings: session.SessionOptions = {\n        secret: process.env.SESSION_SECRET || \"super_secret_key_change_in_prod\",\n        resave: false,\n        saveUninitialized: false,\n        store: storage.sessionStore,\n    };\n\n    if (app.get(\"env\") === \"production\") {\n        app.set(\"trust proxy\", 1);\n    }\n\n    app.use(session(sessionSettings));\n    app.use(passport.initialize());\n    app.use(passport.session());\n\n    passport.use(\n        new LocalStrategy(async (username, password, done) => {\n            const user = await storage.getUserByUsername(username);\n            if (!user || !(await comparePasswords(password, user.password))) {\n                return done(null, false);\n            } else {\n                return done(null, user);\n            }\n        }),\n    );\n\n    passport.serializeUser((user, done) => done(null, (user as SelectUser).id));\n    passport.deserializeUser(async (id: number, done) => {\n        const user = await storage.getUser(id);\n        done(null, user);\n    });\n\n    app.post(\"/api/login\", passport.authenticate(\"local\"), (req, res) => {\n        res.status(200).json(req.user);\n    });\n\n    app.post(\"/api/register\", async (req, res, next) => {\n        try {\n            const existingUser = await storage.getUserByUsername(req.body.username);\n            if (existingUser) {\n                return res.status(400).send(\"Username already exists\");\n            }\n\n            const hashedPassword = await hashPassword(req.body.password);\n            const user = await storage.createUser({\n                ...req.body,\n                password: hashedPassword,\n            });\n\n            req.login(user, (err) => {\n                if (err) return next(err);\n                res.status(201).json(user);\n            });\n        } catch (err) {\n            next(err);\n        }\n    });\n\n    app.post(\"/api/logout\", (req, res, next) => {\n        req.logout((err) => {\n            if (err) return next(err);\n            res.sendStatus(200);\n        });\n    });\n\n    app.get(\"/api/user\", (req, res) => {\n        if (!req.isAuthenticated()) return res.sendStatus(401);\n        res.json(req.user);\n    });\n}\n"],
  "mappings": "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",
  "names": ["import_express", "import_openai", "ws", "ConnectPgSimple", "session", "nodemailer", "import_zod", "p1", "p2", "OpenAI", "rateLimit", "text", "app", "express", "appointments", "OpenAI", "articles", "import_express", "app", "path", "fs", "express", "import_express_session", "app", "session", "passport", "LocalStrategy", "import_fs", "import_path", "express", "helmet", "path", "fs"]
}
